<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>웹 프론트엔드 개발 7주차 수업</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="css/plugins/iCheck/custom.css" rel="stylesheet">
    <!-- Sweet Alert -->
    <link href="css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <!-- Datatable -->
    <link href="css/plugins/dataTables/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="css/plugins/dataTables/responsive.bootstrap.min.css" rel="stylesheet">
    <!-- datepicker -->
    <link href="css/plugins/datepicker/bootstrap-datepicker3.min.css" rel="stylesheet">
</head>

<body>
    <!-- Static navbar -->
    <nav class="navbar navbar-default navbar-static-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Project name</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="#">Home</a></li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">사용자관리 <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="013_user_list.html">사용자리스트</a></li>
                            <li class="active"><a href="011_user_create.html">사용자생성</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Plugins <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="001_icheck.html">iCheck</a></li>
                            <li><a href="002_sweetalert.html">Sweet Alert</a></li>
                            <li><a href="003_datepicker.html">Datepicker</a></li>
                            <li><a href="004_datatable.html">Datatable</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Action</a></li>
                            <li><a href="#">Another action</a></li>
                            <li><a href="#">Something else here</a></li>
                            <li role="separator" class="divider"></li>
                            <li class="dropdown-header">Nav header</li>
                            <li><a href="#">Separated link</a></li>
                            <li><a href="#">One more separated link</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!--/.nav-collapse -->
        </div>
    </nav>
    <div class="container">
        <div class="page-header">
            <h3>사용자 생성</h3>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingOne">
                            <h4 class="panel-title">
						        <a role="button" data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
						          기본정보
						        </a>
					      	</h4>
                        </div>
                        <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">아이디</label>
                                        <div class="col-sm-9">
                                            <div class="input-group">
                                                <input type="text" maxlength="14" id="userid" name="userid" class="form-control" autofocus>
                                                <span class="input-group-btn">
										        	<button class="btn btn-primary" type="button">중복검사</button>
										      	</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">비밀번호</label>
                                        <div class="col-sm-9">
                                            <input type="password" id="password" name="password" class="form-control">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">비밀번호확인</label>
                                        <div class="col-sm-9">
                                            <input type="password" id="confirm_password" name="confirm_password" class="form-control">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">이름</label>
                                        <div class="col-sm-9">
                                            <input type="text" id="username" name="username" class="form-control">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">이메일주소</label>
                                        <div class="col-sm-9">
                                            <input type="text" id="email" name="email" class="form-control">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">주민등록번호</label>
                                        <div class="col-sm-9">
                                            <div class="form-inline">
                                                <input type="text" maxlength="6" id="social_number1" name="social_number1" class="form-control">-
                                                <input type="password" maxlength="7" id="social_number2" name="social_number2" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">생년월일</label>
                                        <div class="col-sm-9">
                                            <input type="text" id="birth_date" name="birth_date" class="form-control">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">성별</label>
                                        <div class="col-sm-9">
                                            <div class="form-inline i-checks">
                                                <label>
                                                    <input type="radio" name="gender" value="M" class="form-control" checked> 남자</label>
                                                <label>
                                                    <input type="radio" name="gender" value="F" class="form-control"> 여자</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">핸드폰</label>
                                        <div class="col-sm-9">
                                            <div class="form-inline">
                                                <input type="text" id="mobile1" name="mobile1" class="form-control" maxlength="3">-
                                                <input type="text" id="mobile2" name="mobile2" class="form-control" maxlength="4">-
                                                <input type="text" id="mobile3" name="mobile3" class="form-control" maxlength="4">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingTwo">
                            <h4 class="panel-title">
						        <a class="collapsed" role="button" data-toggle="collapse" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
						        	추가정보
						        </a>
					      	</h4>
                        </div>
                        <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingTwo">
                            <div class="panel-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">홈페이지</label>
                                        <div class="col-sm-9">
                                            <input type="url" id="homepage" name="homepage" class="form-control">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">성별</label>
                                        <div class="col-sm-9">
                                            <div class="form-inline i-checks">
                                                <label>
                                                    <input type="radio" name="marriage_yn" value="M" class="form-control"> 기혼</label>
                                                <label>
                                                    <input type="radio" name="marriage_yn" value="F" class="form-control" checked> 미혼</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">관심분야</label>
                                        <div class="col-sm-9">
                                            <div class="form-inline i-checks">
                                                <label>
                                                    <input type="checkbox" name="interest_area" value="I001" class="form-control"> IT/컴퓨터</label>
                                                <label>
                                                    <input type="checkbox" name="interest_area" value="I002" class="form-control"> 엔터테인먼트</label>
                                                <label>
                                                    <input type="checkbox" name="interest_area" value="I003" class="form-control"> 스포츠</label>
                                                <label>
                                                    <input type="checkbox" name="interest_area" value="I004" class="form-control"> 쇼핑</label>
                                                <label>
                                                    <input type="checkbox" name="interest_area" value="I005" class="form-control"> 도서/책</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">메일수신동의</label>
                                        <div class="col-sm-9">
                                            <div class="form-inline i-checks">
                                                <label>
                                                    <input type="radio" name="email_yn" value="Y" class="form-control" checked> 동의</label>
                                                <label>
                                                    <input type="radio" name="email_yn" value="N" class="form-control" checked> 거부</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">문자수신동의</label>
                                        <div class="col-sm-9">
                                            <div class="form-inline i-checks">
                                                <label>
                                                    <input type="radio" name="msg_yn" value="Y" class="form-control" checked> 동의</label>
                                                <label>
                                                    <input type="radio" name="msg_yn" value="N" class="form-control" checked> 거부</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12" style="text-align:center;">
                <button type="button" class="btn btn-primary" id="btn_save">저장</button>
                <button type="button" class="btn btn-defalut" id="btn_cancel">취소</button>
            </div>
        </div>
    </div>
    <!-- /container -->
    <script src="js/jquery-2.1.1.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- iCheck -->
    <script src="js/plugins/iCheck/icheck.min.js"></script>
    <!-- Sweet alert -->
    <script src="js/plugins/sweetalert/sweetalert.min.js"></script>
    <!-- Data picker -->
    <script src="js/plugins/datepicker/bootstrap-datepicker.min.js"></script>
    <!-- data tables for bootstrap design-->
    <script src="js/plugins/dataTables/datatables.min.js"></script>
    <script src="js/plugins/dataTables/dataTables.bootstrap.min.js"></script>
    <script src="js/plugins/dataTables/dataTables.responsive.min.js"></script>
    <script src="js/plugins/dataTables/responsive.bootstrap.min.js"></script>
    <script src="js/util.js"></script>
    <script>
    function doCancel() {
        document.location.href = '013_user_list.html';
    }

    function doSave() {
        var id = $('#userid').val();
        var name = $('#username').val();
        var pw = $('#password').val();
        var cpw = $('#confirm_password').val();
        var email = $('#email').val();
        var social_number1 = $('#social_number1').val();
        var social_number2 = $('#social_number2').val();
        var birth_date = $('#birth_date').val();
        var gender = '';
        $('[name=gender]').each(function(){
        	if($(this).parent().hasClass('checked')) gender = $(this).val();
        });

        var mobile1 = $('#mobile1').val();
        var mobile2 = $('#mobile2').val();
        var mobile3 = $('#mobile3').val();
        var homepage = $('#homepage').val();

        var marriage_yn = '';
        $('[name=marriage_yn]').each(function(){
        	if($(this).parent().hasClass('checked')) marriage_yn = $(this).val();
        });

        var oInterest = [];
        $('[name=interest_area]:checked').each(function(){
        	if($(this).parent().hasClass('checked')) oInterest.push(this);
        });

        var email_yn = '';
        $('[name=email_yn]').each(function(){
        	if($(this).parent().hasClass('checked')) email_yn = $(this).val();
        });

        var msg_yn = '';
        $('[name=msg_yn]').each(function(){
        	if($(this).parent().hasClass('checked')) msg_yn = $(this).val();
        });

        if (id == '') {
            alert('아이디를 입력하세요.');
            $('#userid').focus();
            return;
        }

        if (name == '') {
            alert('이름을 입력하세요.');
            $('#username').focus();
            return;
        }

        if (pw == '') {
            alert('비밀번호를 입력하세요.');
            $('#password').focus();
            return;
        }

        if (cpw == '') {
            alert('비밀번호확인을 입력하세요.');
            $('#confirm_password').focus();
            return;
        }

        if (pw != cpw) {
            alert('비밀번호와 비밀번호확인은 같아야 합니다.');
            $('#confirm_password').focus();
            return;
        }

        var data = {};
        data["USER_ID"] = id;
        data["USER_NAME"] = name;
        data["PASSWORD"] = pw;
        data["EMAIL"] = email;
        data["SOCIAL_NUMBER1"] = social_number1;
        data["SOCIAL_NUMBER2"] = social_number2;
        data["BIRTH_DATE"] = birth_date;
        data["GENDER"] = gender;
        data["MOBILE1"] = mobile1;
        data["MOBILE2"] = mobile2;
        data["MOBILE3"] = mobile3;
        data["HOMEPAGE"] = homepage;
        data["MARRIAGE_YN"] = marriage_yn;
        data["EMAIL_YN"] = email_yn;
        data["MSG_YN"] = msg_yn;

        var int_area = [];
        for (var i = 0; i < oInterest.length; i++) {
            int_area.push($(oInterest[i]).val());
        }

        data["INT_AREA"] = int_area;

        console.log(data);

        $.ajax({
            url: "update_server_url", //업데이트 프로그램을 수행하는 서버 url 호출
            async: true,
            header: {},
            data: JSON.stringify(data),
            type: "POST",
            success: function(data) {
                swal({
	                title: "Saved!",   
	                text: "Your request has sent.",   
	                type: "success",   
	                showCancelButton: false,
	                confirmButtonText: "Ok"
	            },function(){
	                document.location.href = '012_user_detail.html';
	            });
            },
            error: function(jqxhr, textStatus, error) {
                var err = textStatus + ", " + error;
                console.log(err);
            }
        });
    }

    $(document).ready(function() {
        $('#birth_date').datepicker({
            format: 'dd/mm/yyyy',
            startView: 0,
            minViewMode: 0,
            maxViewMode: 2,
            autoclose: true
        });

        $('.i-checks').iCheck({
            checkboxClass: 'icheckbox_square-green',
            radioClass: 'iradio_square-green',
        });

		$('#btn_save').click(function(){
            swal({   
                title: "Are you sure to save?",   
                text: "You won't be able to revert this!",   
                type: "warning",   
                showCancelButton: true,   
                confirmButtonColor: "#DD6B55",   
                confirmButtonText: "Yes, save it!",   
                showLoaderOnConfirm: true,
                closeOnConfirm: false
            }, function(){   
            	doSave();
            });
        });

		$('#btn_cancel').click(function(){
			doCancel();
		});

		$('#email').email();
		$('#social_number1').number();
		$('#social_number1').moveNext(6, 'social_number2');
		$('#social_number2').number();
		$('#mobile1').number();
		$('#mobile1').moveNext(3, 'mobile2');
		$('#mobile2').number();
		$('#mobile2').moveNext(4, 'mobile3');
		$('#mobile3').number();
    });
    </script>
</body>

</html>
